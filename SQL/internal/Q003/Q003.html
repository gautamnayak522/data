<p><strong>(Store Procedure/Function/Transaction)40 Marks</strong></p><p>Create a store procedure which accept following JSON Object as input parameter.</p><p>[</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"ProductID": "4",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "UserID":"2",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Qty": "2",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"OrderDate": "2022-07-08"</p><p>&nbsp; &nbsp; &nbsp; &nbsp; },</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"ProductID": "3",</p><p>"UserID":"2",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"Qty": "2",</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"OrderDate": "2022-07-08"</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }&nbsp;</p><p>]</p><p>Following task need to be done&nbsp;</p><ol><li>Parse JSON with the help OpenJson Method.<ol><li>insert the record in the order and orderitem table. Write a logic to calculate OrderAmount based ProductPrice and Qty</li></ol></li></ol><p><strong>Sample Output</strong></p><figure class="table"><table><tbody><tr><td><strong>OrderID</strong></td><td><strong>UserID</strong></td><td><strong>OrderDate</strong></td><td><strong>OrderStatus</strong></td><td><strong>OrderAmount</strong></td><td><strong>DiscountAmount</strong></td><td><p><strong>PayableAmount</strong></p><p>&nbsp;</p></td></tr><tr><td>2</td><td>1</td><td>2022-07-08</td><td>Placed</td><td>21200</td><td>&nbsp;</td><td>&nbsp;</td></tr></tbody></table></figure><p>&nbsp;</p><p>OrderItem</p><figure class="table"><table><tbody><tr><td><strong>OrderItemID</strong></td><td><strong>ProductID</strong></td><td><strong>OrderID</strong></td><td><strong>Qty</strong></td></tr><tr><td>4</td><td>4</td><td>2</td><td>2</td></tr><tr><td>5</td><td>3</td><td>2</td><td>2</td></tr></tbody></table></figure><p>&nbsp;</p><ol><li>Update the DiscountAmount and Payable amount, if discount are available for these product and order date matches with discount start date and end Date</li></ol><p>Sample Output:</p><p>&nbsp;</p><figure class="table"><table><tbody><tr><td><strong>OrderID</strong></td><td><strong>UserID</strong></td><td><strong>OrderDate</strong></td><td><strong>OrderStatus</strong></td><td><strong>OrderAmount</strong></td><td><strong>DiscountAmount</strong></td><td><p><strong>PayableAmount</strong></p><p>&nbsp;</p></td></tr><tr><td>2</td><td>1</td><td>2022-07-08</td><td>Placed</td><td>21200</td><td>4000</td><td>17200</td></tr></tbody></table></figure><p>&nbsp;</p><p>Note: you can create a user defined function if needed.</p>